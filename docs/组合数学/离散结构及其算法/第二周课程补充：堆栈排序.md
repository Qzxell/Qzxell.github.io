---
comments: true
---
# 第二周课程补充：堆栈排序及算法分析
## 堆栈排序
下面介绍 Stack sorting algorithm （堆栈排序），算法的流程如下：
现有如下的数组：

$$
\pi_1 \pi_2 \pi_3 \cdots \pi_n
$$

我们构造一个栈，然后进行如下操作：

1. 将 $\pi_1$ 放入栈中；
2. 将 $\pi_2$ 放入栈中：
	- 如果 $\pi_2<\pi_1$ ，此时直接入栈；
	- 如果 $\pi_2 >\pi_1$ ，此时先让 $\pi_1$ 出栈，再 $\pi_2$ 入栈；
3. 之后所有的流程和上述情况类似，必须要让将要入栈的元素小于栈顶的元素才能入栈，否则就一直弹出元素.
4. 最后，没有元素将要入栈时，将所有栈内的元素依次弹出.

## 模拟程序代码
下面给出模拟堆栈排序的 Python 程序代码，为保持兼容性，仅使用官方标准库.

=== "Python"
    ```python
    # 堆栈排序
    from itertools import permutations

    def if_sorted(t:list) -> bool:
        # 检验是否排列成功
        for i in range(len(t)):
            if i+1 != t[i]:
                return False
        return True


    def stack_sorting(t:tuple) -> None:
        result = [] 
        stack = []
        for item in t:
            # try except 解决空栈的问题
            try: 
                while item >= stack[-1]:
                    result.append(stack.pop())
                stack.append(item)
            except IndexError:
                stack.append(item)
        while stack:
            result.append(stack.pop())
        print(f"{t} 的排序结果为 {result}, 是否排序成功： {if_sorted(result)}")

    if __name__ == '__main__':
        # 对 1~n-1 的数列进行排序
        n = 6
        
        # permutations 用于生成所有排列
        arrs = permutations(range(1,n))
        for arr in arrs:
            stack_sorting(arr)
    ```
=== "MATLAB"
    ```matlab
    clc;clear;close all;
    %%
    num=4;
    Perm=perms(1:num);
    [x,~]=size(Perm);
    for i=1:x
        in=Perm(i,:);
        out=stack_code(in);
        disp(['输入：',num2str(in),'，输出：',num2str(out),'是否为单位排列：',num2str(isequal(out,1:num))])
    end


    function [Output]=stack_code(input)
        stack0=[];Output=[];
        for i=1:length(input)
            passenger=input(i);
            m=find(stack0-passenger<0);
            if isempty(m)
                k=1;
            else
                k=m(end)+1;
            end
            Out=stack0(1:k-1);
            stack0=[passenger,stack0(k:end)];
            Output=[Output,Out];
        end
        Output=[Output,stack0];
    end
    ```