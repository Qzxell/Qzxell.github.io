---
comments: true
---
# 第二周课程补充：堆栈排序及算法分析
## 堆栈排序
下面介绍 Stack sorting algorithm （堆栈排序），算法的流程如下：
现有如下的数组：

$$
\pi_1 \pi_2 \pi_3 \cdots \pi_n
$$

我们构造一个栈，然后进行如下操作：

1. 将 $\pi_1$ 放入栈中；
2. 将 $\pi_2$ 放入栈中：
	- 如果 $\pi_2<\pi_1$ ，此时直接入栈；
	- 如果 $\pi_2 >\pi_1$ ，此时先让 $\pi_1$ 出栈，再 $\pi_2$ 入栈；
3. 之后所有的流程和上述情况类似，必须要让将要入栈的元素小于栈顶的元素才能入栈，否则就一直弹出元素.
4. 最后，没有元素将要入栈时，将所有栈内的元素依次弹出.

## 模拟程序代码
下面给出模拟堆栈排序的 Python 程序代码，为保持兼容性，仅使用官方标准库.

```python
# 堆栈排序
from itertools import permutations

def if_sorted(t:list) -> bool:
    for i in range(len(t)):
        if i+1 != t[i]:
            return False
    return True

def lehmer_code(l:list) -> list:
    lehmer = [0] * len(l)
    for i in range(len(l)):
        for j in range(i,len(l)):
            lehmer[i] += l[i] > l[j]
    return lehmer


def stack_sorting(t:tuple) -> None:
    result = [] 
    stack = []
    for item in t:
        # try except 解决空栈的问题
        try: 
            while item >= stack[-1]:
                result.append(stack.pop())
            stack.append(item)
        except IndexError:
            stack.append(item)
    while stack:
        result.append(stack.pop())
    print(f"{t} 的排序结果为 {result}, {if_sorted(result)},{}")

if __name__ == '__main__':
    arrs = permutations(range(1,6))
    for arr in arrs:
        stack_sorting(arr)
```